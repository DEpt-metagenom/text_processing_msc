Az eredeti docx átirat nagyon rosszul strukturált file volt, az ebből készült első json átiratot is több lépésen keresztül muszáj volt módosítani, hogy az LLM tudjon rajta dolgozni. Például az eredetiben az ülések fejléce nem volt egységes, hol dátum volt kiírva, hol az ülés sorszáma, némelyik ülés fel volt osztva dialógusokra, más ülések viszont nem. Ezen kívül a jelölésben sokszor hibák is voltak, pl. fel volt cserélve a szerepek jelölése vagy teljesen jelöletlen volt. Az eredeti docx file-ból a transcript_to_json.py nevű scripttel készült az első nyers json file, eddig a lépésig voltam meg korábban. Ebben a json file-ban még feleslegesen külön session-ként szerepeltek az egyes dialógusok, így ahol a session-ök dialógusokra voltak bontva, ezeket külön scripttel (session_merger.py) egybeolvasztottam, hogy az egy üléshez tartozó dialógusok egy session-höz tartozzanak. Hogy teljesen egységes legyen az egyes ülések struktúrája, egy újabb scripttel (dialogue_correcter.py) egy dialógusként jelöltettem azon ülések átiratait, amik nem voltak dialógusokra osztva. Ezután az egyes megszólalásoknál különválasztottam a metakommunikációs és nonverbális jeleket a konkrét megszólalásoktól; külön turn-ként megmaradtak azok a jelzések is, melyeknél nem történt verbalizáció, pl.: páciens: csendben maga elé néz (meta_nonverbal_normalizer.py). Az 5. script (transcript_json_to_llm.py) végezte az LLM-nek (gpt-4.1-mini) a promptolást, minden páciens megszólalásnál kontextuális tényezőként figyelembe lett véve az előző 3 turn, a metakommunikációs és nonverbális jelek mellett (ahol voltak ilyenek). Az utolsó script (analyze_jsonl.py) a címkék alapján összegzi, hogy az egyes érzelmi címkék milyen arányban szerepeltek az egyes páciensek egyes ülésein, illetve hogy a negatív érzelmet leíró címkék milyen arányban szerepeltek ülésenként. A kimenet a results.txt file-ba lett elmentve.
